# Role: Legendary Game Architect & Creative Developer
당신은 전력 시스템 전문 지식과 게임 UI/UX 디자인, 그리고 확장성 있는 아키텍처 설계에 능통한 마스터 개발자입니다. 경남 지역 배경의 전력 효율화 RPG인 '에너지그리드(에너지그리드, 이하 에그)'의 웹앱 프로토타입을 React(Vite)로 구현해야 합니다.

# game map은 map.jpg 파일을 참고하세요
# 모르는게 있으면 코드작성을 수행하기전에 중지하게 다시 물어보셔도 됩니다.

# Project Context: '에그(EG)'
- 본 앱은 'kepco-ai-zone'이라는 메인 플랫폼과 분리된 별도의 웹앱입니다.
- 추후 JWT 토큰을 통한 인증과 REST API/Webhook을 통한 EXP(경험치) 및 재화 연동이 예정되어 있습니다.
- 현재는 로컬 데이터를 기반으로 한 연동 테스트 단계이므로, 'Mock API'와 'Local Storage'를 활용한 유연한 구조로 작성하십시오.

# Core Game Logic & UI Requirements
1. [지역 선택 (자유의지)]: 
   - 창원(산업/수요), 진주(기술/혁신), 통영(신재생/풍력), 함안(네트워크/교통) 중 하나를 선택하는 시작 화면을 만드십시오. 각 지역은 고유의 버프(수익 가속, 건설비 할인 등)를 가집니다.
2. [경남 SVG 그리드 맵]: 
   - 경남 지도를 단순화한 SVG 맵을 구현하고, 선택한 지역을 중심으로 거점(노드)을 배치하십시오.
3. [전력 송전 & 업그레이드]:
   - 노드와 노드를 클릭하여 연결하면 '기초 AC 철탑'이 생성됩니다.
   - AC 송전 시 거리에 비례한 전력 손실(붉은 시각 효과)을 시뮬레이션하고, 수익을 차감하십시오.
   - 'HVDC(직류) 변환소'로 업그레이드 시 선로가 네온 블루로 변하며 손실이 0이 되는 '도파민 터지는' 연출을 넣으십시오.
4. [시스템 아키텍처 (통합 대비)]:
   - `useUserStats` 커스텀 훅을 만들어 EXP와 코인 데이터를 관리하십시오. 지금은 로컬에서 작동하지만, 나중에 API 호출로 쉽게 교체할 수 있도록 추상화하십시오.
   - 프로젝트존에서 넘어올 가상의 유저 데이터(JWT Mock) 처리 로직을 포함하십시오.

# Tech Stack
- React, Tailwind CSS, Framer Motion (애니메이션), Lucide React (아이콘)

# Output Expectation
- 한 번에 실행 가능한 완성도 높은 React 코드를 단일 파일 혹은 명확히 구분된 구조로 제공하십시오. 
- 디자인은 사이버펑크와 스마트 시티 느낌이 섞인 세련된 다크 모드 테마를 적용하십시오.
- 사용자에게 "효율화의 쾌감"을 줄 수 있는 인터랙티브한 피드백(파티클, 사운드 팝업 등)을 코드에 녹여내십시오.

"한, 이제 '에그'의 첫 번째 라인을 그려보자. 코드를 생성해줘."

ㅡㅡㅡ
초기 건물지을때 자본금이 필요한데, 맨처음 전력공급에는 발전소,철탑,변전소, 전력케이블,배전지사,전신주,변압기가 필요하잖아? 이건 초기 1셋트는 무료로 주고 이후부터 exp로 코인으로 교환해서 구매하게 할까?
ㅡㅡㅡㅡ

# Role: The Architect of Energy (Designer, Philosopher, Psychologist, & Coder)
당신은 전력 공학의 이성, 게임 디자인의 재미, 마케팅의 감각을 모두 갖춘 마스터 개발자입니다. 프로젝트 '에너지그리드(에너지그리드, 이하 에그)'의 핵심 웹앱을 React(Vite)로 구현하십시오.

# Philosophy & Psychology: '에그'의 세계관
1. [엔트로피와의 전쟁]: 전력 손실(AC)은 무질서와 낭비입니다. 플레이어는 질서(DC)를 통해 경남을 구원하는 '에너지 가디언'입니다.
2. [도파민 루프]: 손실이 발생하면 붉은 연기와 경고음으로 '손실 혐오'를 자극하고, DC 업그레이드 시 네온 블루 효과와 경쾌한 사운드로 '효율의 쾌감'을 폭발시킵니다.
3. [자유의지]: 경남의 각 도시(창원, 진주, 통영, 함안)는 각기 다른 사회적/지리적 가치를 지닌 '클래스'입니다.

# Game Design: 핵심 시스템 (에그 아키텍처)
1. [초기 스타터 팩 (The Genesis Set)]: 
   - 모든 유저에게 첫 번째 송배전 세트(발전소, 철탑, 변전소, 케이블,전신주, 변압기)를 '무료'로 지급하여 성공 경험을 제공합니다.
   - 이후의 추가 건설은 'kepco-ai-zone'에서 연동된 EXP를 코인으로 환전하여 구매해야 합니다.
2. [경제 시스템]: 
   - `EXP_TO_COIN_RATIO`를 설정하여 유저의 활동이 자본으로 치환되는 메커니즘을 구현하십시오.
3. [SVG 인터랙티브 맵]: 
   - 경남 지도를 단순화하여 구현하고, 노드(변전소/발전소)와 엣지(철탑/케이블)를 드래그로 연결하는 직관적인 UX를 제공하십시오.
4. [전력 흐름 로직]:
   - AC Mode: 거리에 따른 저항 및 전력 손실 시뮬레이션. 
   - DC Mode: HVDC/LVDC 업그레이드 시 효율 최적화 시각화.

# Technical Architecture: 'kepco-ai-zone' 연동 대비
1. [Decoupled Architecture]: 메인 플랫폼과 분리된 독립 웹앱으로 설계하십시오.
2. [Mock API Layer]: 추후 DB 및 JWT 연동을 위해 `useEggAuth`, `useEggEconomy` 커스텀 훅을 만들어 데이터 통신 로직을 추상화하십시오.
3. [Local Storage Persistence]: 현재는 로컬DB 상태이므로, 게임 상태를 브라우저에 저장하여 새로고침 시에도 유지되게 하십시오.

# UI/UX Style
- Theme: Cyberpunk Smart City (다크 모드, 네온 블루/옐로우 포인트)
- Interaction: Framer Motion을 활용한 부드러운 전환과 파티클 효과.

"한, 경남의 에너지를 부화시킬 준비가 되었습니다. 코드를 생성하십시오."



ㅡㅡㅡ
게임시작시에는 불꺼진 마을과 산업단지만 존재해야겠네. 초기스타터팩으로 시작하는거야. 이거 맞아?

ㅡㅡㅡ

# Role: The Grid Overlord (Game Architect & System Engineer)
당신은 전력 계통의 논리와 게임 디자인의 예술을 결합한 마스터 개발자입니다. 프로젝트 '에너지그리드(에그)'의 메인 웹앱 프로토타입을 React(Vite)로 구현하십시오.

# Visual & Narrative Concept: "Hatch the Dark Gyeongnam"
# game map은 map.jpg 파일을 참고하세요
1. [배경]: 현대~근미래의 스마트 시티. 다크 모드 기반에 네온 블루/골드 포인트의 사이버펑크 감성.
2. [초기 상태]: 게임 시작 시 경남 지도는 전력이 차단되어 어둡습니다(Blackout). 주요 거점만 희미하게 빛납니다.
3. [온보딩]: 유저는 '스타터팩'을 통해 어두운 도시에 첫 번째 불을 밝히는 '에너지 가디언'의 서사를 시작합니다.

# Game Design: 핵심 시스템 및 UI
1. [스타터팩 (The First Light)]: 
   - 초기 1세트 무료 지급: 발전소, 철탑, 변전소, 전력케이블, 전신주, 변압기.
   - 드래그 앤 드롭 혹은 순차 클릭 방식으로 전력 계통을 완성하게 하십시오.
2. [전력 효율 로직]:
   - AC 송전: 선로 길이에 비례한 손실 시뮬레이션 (붉은 스파크/연기 효과).
   - DC 업그레이드: 변전소를 HVDC로 전환 시 네온 블루 이펙트와 함께 손실 0 구현.
3. [경제 시스템 (API 연동 대비)]:
   - EXP(경험치)를 코인으로 환전하는 UI를 포함하십시오. 
   - 현재는 Local Storage와 Mock Data를 활용해 상태를 유지하십시오.
4. [지역 선택 (자유의지)]:
   - 창원(산업), 진주(혁신), 통영(풍력), 함안(네트워크) 중 선택 시 해당 지역의 특화 버프 적용.

# Technical Stack
- React, Tailwind CSS, Framer Motion (고급 애니메이션 필수), Lucide React (아이콘).
- 모든 데이터 로직은 `useEggEngine`, `useEggUser` 같은 커스텀 훅으로 분리하여 추상화하십시오.

# Interaction Requirement
- 전력이 최종 변압기까지 도달해 마을의 불이 켜질 때, 화면 전체에 화려한 'Grid Reconnected' 파티클 효과를 연출하십시오.

"이제 경남의 어둠을 걷어낼 '에그'의 첫 번째 코드를 작성하십시오."

------
일단 깃허브랑 연동하고 커밋까지 해줘
https://github.com/kai01235813-eng/energy_grid_game

--------

map.jpg 이미지(경남 지도) 위에 전력설비가 설치되야해. 
그래야 사람들이 재밌어해
그래픽이 반영되도록 다시 만들어줘.

------

# Role: The Realist Grid Architect (Senior Front-End Developer & UX Specialist)
당신은 리액트(React) 환경에서 이미지 기반의 인터랙티브 맵을 구현하는 데 최고 전문가입니다. 현재 프로토타입의 추상적인 그리드 배경은 플레이어의 몰입을 방해하고 있습니다. 우리의 목표는 실제 지형 위에 설비를 건설하는 리얼한 경험을 제공하는 것입니다.

# Critical Task: 배경 맵 교체 및 좌표 시스템 재정의
추상적인 배경을 제거하고, 제가 제공하는 실제 경남 지도 이미지를 게임의 메인 캔버스로 사용하도록 코드를 전면 수정하십시오.

# Technical Implementation Guide (React + Tailwind CSS)
1. [이미지 에셋 통합]:
   - 제공된 경남 지도 이미지 파일(예: `energy_grid_game/map_bg.jpg`)을 프로젝트에 임포트하십시오.
2. [메인 게임 컨테이너 수정]:
   - 현재의 그리드 그리기 로직을 완전히 제거하십시오.
   - 메인 게임 영역(`div`)의 스타일을 다음과 같이 설정하여 지도가 배경으로 깔리게 하십시오.
   - `position: relative;` (자식 요소들의 절대 좌표 기준점이 됨)
   - `background-image: url(imported_map_image);`
   - `background-size: cover;` 또는 `contain;` (화면 비율에 맞춰 조정, 맵이 잘리지 않는 것이 중요)
   - `background-position: center;`
   - `width: 100%; height: [적절한 높이 또는 뷰포트 기준];`
3. [설비 및 노드 배치 방식 변경]:
   - 기존의 그리드 좌표계 대신, 이 배경 이미지 위에서의 **절대 좌표(Absolute Position)** 또는 **퍼센트(%) 기반 좌표**를 사용하여 도시 노드, 발전소, 철탑 등을 배치해야 합니다.
   - 예: 창원 노드는 `style={{ position: 'absolute', top: '60%', left: '55%' }}` 와 같이 실제 지도상의 위치에 고정되어야 합니다.
4. [기존 로직 유지]:
   - 스타터팩 지급, 건물 건설, UI 오버레이 등 기존의 게임 로직은 그대로 유지하되, 렌더링되는 바닥판만 실제 이미지로 교체되어야 합니다.

# Output Requirement
- 수정된 `GameMap.jsx` (또는 메인 컴포넌트) 코드를 제공하십시오.
- CSS(Tailwind 클래스)가 배경 이미지와 아이템 배치에 어떻게 적용되었는지 주석으로 명확히 설명하십시오.

"한, 가짜 그리드는 버려라. 이제 플레이어들은 진짜 경남 땅 위에 철탑을 세우게 될 것이다. 코드를 수정하라."

---

경남맵 파일을 못불러오는거같은데 맞지?


---
# Role: Debugging Master & React Architect
지금 'GyeongnamMap.jsx'에서 `TypeError: Cannot read properties of undefined (reading 'find')` 에러가 발생하며 화면이 검은색으로 뜹니다. 이 크래시를 해결하고 지도를 정상화하십시오.

# Critical Fix: 데이터 안전성 확보
1. [Optional Chaining 도입]: 
   - `gameState.nodes.find(...)` 처럼 데이터를 찾는 모든 로직에 `?.`를 붙여서 데이터가 없을 때 앱이 죽지 않게 하십시오. (예: `gameState?.nodes?.find(...)`)
2. [초기값 보장]:
   - `gameState`의 초기 상태(Initial State)에서 `nodes`, `lines`, `demandPoints` 등이 반드시 '빈 배열([])'로 선언되어 있는지 확인하고 수정하십시오.
3. [이미지 경로 및 렌더링 확인]:
   - `public/map.jpg`를 불러오는 부분에서 이미지가 로드되기 전에는 '로딩 중' 화면을 띄우고, 로드된 후에만 맵을 그리도록 로직을 보강하십시오.
4. [Container Height]:
   - 메인 `div`에 `h-screen` 또는 `h-[800px]` 같은 명확한 높이값이 있는지 다시 점검하십시오.

"한, 논리 에러를 수정하고 경남 지도를 즉시 복구하라. 코드를 다시 생성하라."
---

지금 다시 에그게임으로 돌아와서, 지도가 경남지역이 잘 안보이고, 건물을 어떻게 지었는지도 보이지가 않아. 그리고 게임을 테스트하는 용도의 개발자모드가 필요할거같아. 왜냐면 건물 지어진지 확인도 하고 데이터를 다시 삭제하기도 하면서 테스트를 해봐야 하거든. 클로드 프롬프트로 만들어줘


---

# Role: Senior Game Engine Architect & Lead Developer
우리는 '에너지그리드(에그)'의 시각적 오류를 해결하고, 효율적인 테스트를 위한 '개발자 전용 대시보드'를 구축해야 합니다.

# Task 1: 시각적 가시성 및 레이어 정규화 (Visibility Fix)
1. [지도 렌더링 보장]: 
   - `map.jpg` 이미지가 컨테이너의 `z-index: 0`에 확실히 위치하게 하고, `object-fit: contain`을 사용하여 비율 왜곡 없이 화면에 가득 차게 하십시오.
2. [건물 및 전력선 가시성]: 
   - 모든 건설된 설비(노드)와 전력선(에지)은 지도의 상위 레이어(`z-index: 10` 이상)에 렌더링하십시오.
   - 설비 아이콘이 지도 배경색에 묻히지 않도록 아이콘 외곽선(Drop Shadow)이나 글로우 효과를 추가하십시오.
   - 전력선(SVG)은 `stroke-width`를 3px 이상으로 설정하여 눈에 띄게 하십시오.

# Task 2: 개발자 모드(Dev Mode) UI 구현
화면 우측 상단에 접이식 'Admin Panel'을 추가하십시오.
1. [상태 모니터링]: 현재 설치된 설비 리스트, 현재 EXP/코인 잔액을 실시간으로 텍스트로 표시하십시오.
2. [데이터 조작]:
   - 'EXP +1000 / 코인 +1000' 버튼 (테스트용 자금 충전)
   - '모든 건물 철거' 버튼 (gameState 초기화 및 localStorage 삭제)
   - '강제 불 밝히기' 버튼 (전력 공급 로직 무시하고 시각 효과 테스트)
3. [좌표 디버깅]: 맵 클릭 시 해당 지점의 {x: %, y: %} 좌표를 콘솔이나 패널에 띄워 건물을 정확한 위치에 배치할 수 있게 도와주십시오.

# Technical Requirements
- React의 `useState`와 `useEffect`를 활용하여 개발자 모드의 온/오프 상태를 관리하십시오.
- `localStorage.clear()` 기능을 버튼 하나로 실행할 수 있게 연동하십시오.
- 레이아웃이 깨지지 않도록 `relative`와 `absolute` 포지셔닝을 엄격히 구분하여 코드를 재작성하십시오.

"한, 이제 보이지 않던 에너지를 시각화하고, 신의 권능(개발자 모드)으로 그리드를 통제하라. 코드를 수정하라."

🛠️ 개발자 모드 활용 팁
좌표 찾기: 지도를 클릭했을 때 클릭한 지점의 % 좌표가 뜨게 하면, 나중에 창원이나 진주 위치를 코드로 박을 때 "여기가 65% 지점이구나" 하고 바로 알 수 있어 노가다가 줄어들어.

초기화의 마법: 코드를 고쳤는데 이전 데이터랑 꼬여서 에러가 난다면, 우리가 만든 개발자 모드의 '데이터 삭제' 버튼을 누르고 새로고침해 봐. 깨끗한 상태에서 다시 시작할 수 있어.

----

그리고 지금 구조물을 지으면 그래픽이 하나도 안보이니까 아이콘으로 지도위에 표시되도록 만들어주고 아이콘은 매우 현실을 반영하면서도 아기자기해야해. 프롬프트 만들어줘

---

# Role: 전력 계통 재난 대응 AI 아키텍트 및 게임 개발자

# Task: 'AI 재난대응 지원시스템' 시뮬레이션 게임 개발

# Context:: 전력산업의 디지털 트윈 게임버전으로, 실제 전력설비를 게임으로 시뮬레이션 구현하여 AC 전력망을 DC전력망(HVDC,LVDC,MVDC)으로 전환하고 효율성을 체감하면서, 자연의 기상상황(산불,번개 등)에 대처하는 것을 게임을 통해 실제에서도 도움될수있도록 만드는 인터렉티브 시뮬레이션 게임이야. 이 의도와 맞지 않는 기능은 삭제해도 상관없어.

#기능 추가 : 사용자가 제안한 'AI 재난대응 지원시스템'의 핵심 기능을 시각화하고 체험할 수 있는 인터랙티브 대시보드 형태의 게임을 React와 Tailwind CSS를 사용하여 제작해줘. 이 시스템은 기상 이변(산불, 집중호우 등)으로부터 전력망을 보호하는 것을 목표로 함. 

# Core Game Mechanics:
1. 랜덤으로 변하는(20초당 기후가 변하게 됨) 기상 데이터에 따라 구역별 리스크를 색상(초록->노랑->빨강)으로 표시.
2. AI 권고 엔진: 재난 발생 시 AI가 "산불 발생 출동 알람" 또는 "우회 경로 확보"와 같은 전략을 텍스트로 추천.
3. 자원 관리: 제한된 수리 크루(Repair Crew)와 예산을 활용하여 정전 피해를 최소화해야 함.
4. 리얼타임 로그: "OO 변전소 과부하 위험", "산불 확산 중" 등 긴박한 상황 메시지 출력.

# Technical Requirements:
- 가상의 '송배전 계통 정보'와 '기상 데이터'를 결합한 통합 분석 로직 포함.
- 정전 범위 및 피해 규모(정전 고객 수)를 실시간으로 계산하는 Dashboard 섹션.
- Lucide-react 아이콘을 사용하여 변압기, 전주, 번개 등의 시각적 요소 강화.

# Tone & Style:
- 전문적이고 신뢰감 있는 다크 모드 UI.
- 전력산업의 긴박함이 느껴지는 데이터 중심의 디자인.

# Output:
전체 코드를 하나의 파일로 작성하여 React Artifact로 출력해줘.
----
# Role: 전력 계통 전문 게임 디자이너 및 React 개발자

# Game Title: "Energy Genesis: 전력 계통 진화 RPG"

# Concept:
플레이어가 발전기, 송전철탑, 변전소를 건설하여 도시의 전력 수요를 충당하는 시대별 진화 RPG 시뮬레이션 게임.

# Gameplay Phases:
1. [태동기]: 석탄 발전기와 초기 송전선로. 수동 복구 위주.
2. [성장기]: 대형 발전소, 고압 송전철탑, 변전소 자동화 도입.
3. [혁신기]: 신재생 에너지, AI(Agentic AI, RAG), 디지털 트윈을 활용한 지능형 전력망. (사용자 제공 기술 데이터 반영) [cite_start][cite: 1]

# Core Rules:
- 요소: 발전기(Generator), 송전철탑(Tower), 변전소(Substation).
- 연결 로직: 변전소를 지으면 근처의 철탑과 자동으로 케이블이 연결되어 에너지가 흐름.
- 게임진행 조건: 시대별 요구 전력량(MW)을 안정적으로 공급하고 기술 포인트를 모아 다음 시대로 진화.
- 리스크: 과부하 시 변전소 고장. [cite_start]미래 단계에서는 'AI 재난대응 시스템'으로 자동 복구 가능. 

# Technical Specifications:
- UI: 상단에 예산, 현재 전력 공급률, 기술 포인트 표시.
- Canvas: 그리드 시스템을 사용하여 건물 배치.
- 연출: 에너지가 흐를 때 철탑 사이의 선에 빛이 흐르는 애니메이션.
- 스타일: 다크 모드 기반의 하이테크 느낌, Tailwind CSS 사용.

# Integration of Tech Data:
기술 트리(Tech Tree)에 다음 항목 포함:
- [cite_start]OCR/IDP: 문서 처리 자동화로 운영비용 절감. 
- [cite_start]디지털 트윈: 고장 예측 확률 상승. 
- [cite_start]Agentic AI: 사고 발생 시 자동 복구 로직 활성화. 

전체 로직을 포함한 단일 파일 React 코드를 생성해줘.

----

이 게임의 목적은 전력산업 발전 변천사 RPG야. 내가 직접 발전부터 송전 변전까지 해서 지역에 전기를 공급하는거지. 아주 처음의 발전부터 시작해서, 과거 전력설비가 처음 들어왔을때처럼 전기공급을 해보다가, 점점 지능화&효율화&신재생화 되는거지. 아무래도 전력케이블, 전신주는 빼고, 발전기, 송전철탑, 변전소(변전소 지으면 송전케이블은 알아서 철탑이랑 연결됨)만으로 구성해서 다시 시뮬레이션 게임을 만들어줘
----





